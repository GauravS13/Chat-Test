<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Decentralized Game Room</title>
    <meta
      name="description"
      content="P2P games (Tic-Tac-Toe, Connect Four, Number Guessing)."
    />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="app">
      <header class="site-header" role="banner">
        <div class="container">
          <h1 id="appTitle">ðŸŽ® Decentralized Game Room</h1>
          <p class="lead">P2P games with offline-first support</p>
        </div>
      </header>

      <main id="main" class="container" role="main">
        <!-- Lobby -->
        <section id="lobby" class="view">
          <h2>Choose a game</h2>
          <div class="game-selection" role="list">
            <button
              class="btn game-card"
              data-game="tictactoe"
              role="listitem"
              aria-label="Tic Tac Toe"
            >
              ðŸŽ¯ <span>Tic-Tac-Toe</span>
            </button>
            <button
              class="btn game-card"
              data-game="connect4"
              role="listitem"
              aria-label="Connect Four"
            >
              ðŸ”´ <span>Connect Four</span>
            </button>
            <button
              class="btn game-card"
              data-game="numguess"
              role="listitem"
              aria-label="Number Guessing"
            >
              ðŸ”¢ <span>Number Guessing</span>
            </button>
          </div>
        </section>

        <!-- Game Mode / Actions -->
        <section id="gameMode" class="view hidden" aria-hidden="true">
          <h2 id="selectedGameTitle">Game</h2>
          <div class="actions">
            <button class="btn primary" data-action="create">
              Create Room
            </button>
            <button class="btn" data-action="join">Join Room</button>
            <button class="btn secondary" data-action="ai">Play vs AI</button>
            <button class="btn" data-action="hotseat">Hotseat</button>
            <button class="btn ghost" data-action="back">Back</button>
          </div>
        </section>

        <!-- Game screen -->
        <section id="game" class="view hidden" aria-hidden="true">
          <header class="game-header">
            <h2 id="gameTitle">Game</h2>
            <div id="gameControls">
              <button class="btn ghost" data-action="rematch">Rematch</button>
              <button class="btn ghost" data-action="home">Home</button>
            </div>
          </header>

          <!-- Boards -->
          <div
            id="tictactoeBoard"
            class="game-board hidden"
            aria-live="polite"
          ></div>
          <div
            id="connect4Board"
            class="connect4-board hidden"
            aria-live="polite"
          ></div>

          <div id="numguessControls" class="hidden">
            <div class="game-info">
              <div id="numguessInfo">Guess a number between 1 and 100!</div>
              <div id="numguessAttempts">Attempts: 0</div>
            </div>
            <div class="numguess-input-wrap">
              <input
                id="numguessInput"
                class="numguess-input"
                type="number"
                inputmode="numeric"
                min="1"
                max="100"
                aria-label="Your guess"
              />
              <button class="btn primary" data-action="guess">Guess</button>
            </div>
          </div>

          <aside id="gameInfo" class="game-info-panel" aria-live="polite">
            <div id="scoreDisplay" class="score-display"></div>
            <div id="gameStatus" class="status">Ready</div>
          </aside>
        </section>
      </main>

      <!-- Manual handshake modal (accessible) -->
      <div
        id="handshakeModal"
        class="modal"
        role="dialog"
        aria-modal="true"
        aria-hidden="true"
        aria-labelledby="handshakeTitle"
      >
        <div class="modal-inner" role="document">
          <header class="modal-header">
            <h3 id="handshakeTitle">Manual P2P Handshake</h3>
            <button
              class="modal-close"
              data-action="close-modal"
              aria-label="Close"
            >
              Ã—
            </button>
          </header>
          <div class="modal-body">
            <div id="modeSelection">
              <p>Choose your role</p>
              <div class="stack">
                <button class="btn" data-action="start-create">
                  Generate Offer
                </button>
                <button class="btn" data-action="start-join">
                  I have an offer
                </button>
              </div>
            </div>

            <div id="createMode" class="hidden">
              <label for="offerText" class="sr-only">Offer</label>
              <textarea
                id="offerText"
                readonly
                class="manual-textarea"
              ></textarea>
              <div class="row">
                <button class="btn" data-action="copy-offer">Copy Offer</button>
                <button class="btn" data-action="show-answer-input">
                  Paste Answer
                </button>
              </div>
              <textarea
                id="answerInput"
                placeholder="Paste acceptor's answer here"
                class="manual-textarea hidden"
              ></textarea>
              <div class="row">
                <button class="btn primary hidden" data-action="submit-answer">
                  Connect
                </button>
              </div>
            </div>

            <div id="joinMode" class="hidden">
              <label for="receivedOfferInput" class="sr-only"
                >Received Offer</label
              >
              <textarea
                id="receivedOfferInput"
                placeholder="Paste the offer you received"
                class="manual-textarea"
              ></textarea>
              <div class="row">
                <button class="btn primary" data-action="generate-answer">
                  Generate Answer
                </button>
                <button
                  class="btn"
                  data-action="copy-answer"
                  style="display: none"
                >
                  Copy Answer
                </button>
              </div>
              <textarea
                id="answerText"
                readonly
                class="manual-textarea hidden"
              ></textarea>
            </div>
          </div>
        </div>
      </div>

      <!-- Debug panel (collapsed by default) -->
      <div id="debugPanel" class="debug-panel collapsed" aria-hidden="true">
        <button id="debugToggle" class="btn tiny">âš™</button>
        <div id="debugContent" class="debug-content hidden">
          <div>Memory: <strong id="memoryUsage">--</strong></div>
          <div>Online: <strong id="onlineStatus">--</strong></div>
          <div>Peer: <strong id="peerStatus">--</strong></div>
          <div>Mode: <strong id="gameState">--</strong></div>
          <div>
            <button class="btn tiny" data-action="export-memory">
              Export Memory
            </button>
          </div>
        </div>
      </div>

      <footer class="site-footer">
        <div class="container">
          <small>Decentralized Game Room</small>
        </div>
      </footer>

      <script src="app.js" defer></script>
    </div>
  </body>
</html>
